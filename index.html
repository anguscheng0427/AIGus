<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <title>Whisper 轉錄工具 - Colab 啟動器</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --google-blue: #4285F4;
            --google-blue-hover: #357ae8;
            --google-yellow: #f4b400;
            --google-yellow-hover: #f2a600;
            --text-primary: #333;
            --text-secondary: #5f6368;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --border-color: #dfe1e5;
            --status-bg: #f1f3f4;
            --status-success: #e6f4ea;
            --status-error: #fce8e6;
            --input-bg: #f1f3f4;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", "Helvetica Neue", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
            border: 1px solid var(--border-color);
            padding: 2.5rem;
            max-width: 600px;
            width: 100%;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo {
            font-size: 3rem;
            line-height: 1;
            margin-bottom: 1rem;
        }

        h1 {
            color: var(--text-primary);
            font-size: 1.75rem;
            margin: 0;
        }

        p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s ease;
            width: 100%;
            box-sizing: border-box; /* 確保 padding 不會撐爆寬度 */
        }

        .button svg {
            margin-right: 12px;
            width: 20px;
            height: 20px;
        }

        .button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .g-btn {
            background-color: var(--google-blue);
            color: white;
        }
        .g-btn:hover:not(:disabled) {
            background-color: var(--google-blue-hover);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .launch-btn {
            background-color: var(--google-yellow);
            color: #333;
            margin-top: 1.5rem; /* 與表單分隔 */
        }
        .launch-btn:hover:not(:disabled) {
            background-color: var(--google-yellow-hover);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        #status {
            background-color: var(--status-bg);
            border: 1px solid var(--border-color);
            padding: 12px;
            border-radius: 5px;
            margin-top: 1.5rem;
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #status.status-info { background-color: var(--status-bg); }
        #status.status-success { background-color: var(--status-success); color: #1e8e3e; }
        #status.status-error { background-color: var(--status-error); color: #d93025; }
        #status.status-loading {
            background-color: #e8f0fe; /* Google Blue light */
            color: #1967d2;
        }
        
        .loader {
            width: 16px;
            height: 16px;
            border: 2px solid currentColor;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- 新增的表單樣式 --- */
        #config_form {
            display: none; /* 預設隱藏 */
            margin-top: 2rem;
            text-align: left;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        /* 在小螢幕上變為單欄 */
        @media (max-width: 600px) {
            .form-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .form-group select,
        .form-group input {
            font-size: 1rem;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            width: 100%;
            box-sizing: border-box;
        }
        .form-group select:focus,
        .form-group input:focus {
            outline: 2px solid var(--google-blue);
            background-color: var(--card-bg);
            border-color: var(--google-blue);
        }

        .form-group.full-width {
            grid-column: 1 / -1; /* 佔滿整行 */
        }
        
        hr {
            border: none;
            border-top: 1px solid var(--border-color);
            margin: 1.5rem 0;
        }
        
        footer {
            margin-top: 2rem;
            font-size: 0.8rem;
            color: #aaa;
            text-align: center;
        }

        footer a {
            color: #999;
            text-decoration: none;
        }
        footer a:hover {
            color: var(--text-primary);
        }

    </style>

    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</head>
<body>

    <div class="container">
        <header>
            <div class="logo">🎙️</div>
            <h1>Whisper 轉錄工具</h1>
        </header>

        <main>
            <p>本工具將在您自己的 Google Colab 環境中執行 Whisper。請先登入，並設定轉錄參數。</p>

            <button id="authorize_button" class="button g-btn">
                <svg viewBox="0 0 48 48">
                    <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                    <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                    <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                    <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                    <path fill="none" d="M0 0h48v48H0z"></path>
                </svg>
                1. 使用 Google 帳號登入
            </button>
            
            <form id="config_form">
                <hr>
                <h2>2. 轉錄參數設定</h2>
                <div class="form-grid">
                    
                    <div class="form-group">
                        <label for="model_select">模型 (Model)</label>
                        <select id="model_select">
                            <option value="large-v3">large-v3 (推薦)</option>
                            <option value="large-v2">large-v2</option>
                            <option value="large">large</option>
                            <option value="medium">medium</option>
                            <option value="small">small</option>
                            <option value="base">base</option>
                            <option value="tiny">tiny</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="lang_select">語言 (Language)</label>
                        <select id="lang_select">
                            <option value="Chinese">中文 (Chinese)</option>
                            <option value="English">英文 (English)</option>
                            <option value="">自動偵測 (Auto)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="task_select">任務 (Task)</label>
                        <select id="task_select">
                            <option value="transcribe">語音轉文字 (transcribe)</option>
                            <option value="translate">翻譯成英文 (translate)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="format_select">輸出格式 (Format)</label>
                        <select id="format_select">
                            <option value="all">所有格式 (all)</option>
                            <option value="txt">純文字 (txt)</option>
                            <option value="srt">字幕 (srt)</option>
                            <option value="vtt">字幕 (vtt)</option>
                            <option value="tsv">TSV</option>
                            <option value="json">JSON</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="output_dir_input">輸出資料夾 (Output Dir)</label>
                        <input type="text" id="output_dir_input" value="./result" placeholder="留空則輸出在當前資料夾">
                    </div>

                    <div class="form-group full-width">
                        <label for="device_select">執行裝置 (Device)</label>
                        <select id="device_select">
                            <option value="cuda">GPU (T4 推薦)</option>
                            <option value="cpu">CPU (速度慢)</option>
                        </select>
                    </div>

                </div>
            </form>
            
            <button id="create_button" class="button launch-btn" style="display:none;">
                <svg viewBox="0 0 32 32" fill="currentColor">
                    <path d="M16,2.5c-0.3,0-0.6,0-0.9,0.1C13.8,2.8,12.5,3.4,11.3,4.1C7.3,6.5,4.1,10.7,4.1,15.4c0,0.2,0,0.5,0,0.7c0,0.3,0,0.6,0.1,0.9c0.2,1.3,0.8,2.6,1.5,3.8c2.4,4,6.6,7.2,11.3,7.2c0.2,0,0.5,0,0.7,0c0.3,0,0.6,0,0.9-0.1c1.3-0.2,2.6-0.8,3.8-1.5c4-2.4,7.2-6.6,7.2-11.3c0-0.2,0-0.5,0-0.7c0-0.3,0-0.6-0.1-0.9c-0.2-1.3-0.8-2.6-1.5-3.8C25.7,6.5,21.5,3.3,16.8,3.3C16.5,3.3,16.2,3.3,16,3.3C16,2.9,16,2.7,16,2.5z M16.4,26.5c-4,0-7.4-2.2-9.1-5.3c-0.6-1-0.9-2.1-1.1-3.2c-0.1-0.5-0.1-1-0.1-1.5c0-0.5,0-1,0.1-1.5c0.1-1.1,0.5-2.2,1.1-3.2C8.9,8.7,12.3,6.5,16.4,6.5c1.1,0,2.2,0.3,3.2,0.9c1,0.6,1.9,1.4,2.6,2.3c0.7,0.9,1.3,1.9,1.7,3c0.1,0.2,0.2,0.5,0.2,0.8c0.3,1,0.4,2,0.4,3c0,0.5,0,1-0.1,1.5c-0.1,1.1-0.5,2.2-1.1,3.2c-1.8,3.1-5.1,5.3-9.1,5.3C16.6,26.5,16.5,26.5,16.4,26.5z"></path>
                    <path d="M12.9,10.1c-0.5-0.3-1.1-0.2-1.4,0.3c-0.3,0.5-0.2,1.1,0.3,1.4c1,0.6,1.6,1.7,1.6,2.8c0,1.1-0.6,2.2-1.6,2.8c-0.5,0.3-0.6,0.9-0.3,1.4c0.2,0.4,0.6,0.5,1,0.5c0.2,0,0.3,0,0.5-0.1c1.5-0.9,2.5-2.5,2.5-4.2C15.4,12.6,14.4,11,12.9,10.1z"></path>
                    <path d="M19.1,10.1c-1.5,0.9-2.5,2.5-2.5,4.2c0,1.7,1,3.3,2.5,4.2c0.2,0.1,0.3,0.1,0.5,0.1c0.4,0,0.8-0.2,1-0.5c0.3-0.5,0.2,1.1-0.3-1.4c-1-0.6-1.6-1.7-1.6-2.8c0-1.1,0.6-2.2,1.6-2.8c0.5-0.3,0.6-0.9,0.3-1.4C19.9,10.3,19.6,10.2,19.1,10.1z"></path>
                </svg>
                3. 建立並啟動轉錄筆記本
            </button>
            
            <div id="status" class="status-info">狀態：等待登入...</div>
        </main>

        <footer>
            <a href="https://github.com/openai/whisper" target="_blank" rel="noopener noreferrer">Whisper</a> &bull; 
            <a href="https://colab.research.google.com/" target="_blank" rel="noopener noreferrer">Google Colab</a> &bull; 
            <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>
        </footer>
    </div>

    <script>
        // =========================================================================
        // 設定區：請填入您的 Google API 憑證
        // =========================================================================
        
        // 1. 替換成您在 Google Cloud Console 取得的 Client ID
        const CLIENT_ID = '948448508017-piu3l6tiqum3n28hivbqg3al6n8c0api.apps.googleusercontent.com'; 
        
        // 2. 這是 Google Drive API 的權限範圍 (scope)
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';
        
        // =========================================================================
        // (Part 2) Colab 筆記本模板 (儲存為 JSON 物件)
        // *** 這是最新的「單一按鈕」簡化版 ***
        // *** 注意：第一個 cell (設定檔) 將由 JS 動態插入 ***
        // =========================================================================
        const COLAB_NOTEBOOK_TEMPLATE = {
            "nbformat": 4,
            "nbformat_minor": 0,
            "metadata": {
                "colab": {
                    "name": "Whisper 轉錄筆記本 (自動產生)",
                    "provenance": []
                },
                "kernelspec": {
                    "name": "python3",
                    "display_name": "Python 3"
                },
                "language_info": {
                    "name": "python"
                }
            },
            "cells": [
                {
                    "cell_type": "markdown",
                    "metadata": { "id": "intro-md" },
                    "source": [
                        "# Whisper 語音轉錄工具 (單一按鈕版)\n\n",
                        "您的參數（模型、語言等）已經從啟動網頁載入。\n\n",
                        "**重要提示：** 為了獲得最佳（免費）轉錄速度，請先設定 GPU：\n\n",
                        "1.  點擊頂端選單的「**執行階段**」(Runtime)\n",
                        "2.  選擇「**變更執行階段類型**」(Change runtime type)\n",
                        "3.  在「硬體加速器」下拉選單中，選擇「**T4 GPU**」\n",
                        "4.  點擊「**儲存**」\n\n",
                        "--- \n",
                        "### 🚀 開始執行\n\n",
                        "**請點擊下方儲存格左側的「播放」按鈕**，即可依序完成：\n",
                        "1.  安裝 Whisper 函式庫\n",
                        "2.  跳出視窗讓您上傳音檔\n",
                        "3.  依照您設定的參數執行轉錄"
                    ]
                },
                {
                    "cell_type": "code",
                    "metadata": { "id": "run-all-cell", "colab": {} },
                    "source": [
                        "import os\n",
                        "from google.colab import files\n\n",
                        "# --- 步驟 1：安裝 Whisper ---\n",
                        "print(\"--- 步驟 1/3：正在安裝 Whisper... ---\")\n",
                        "!pip install git+https://github.com/openai/whisper.git > /dev/null\n",
                        "print(\"Whisper 安裝完成。\\n\")\n\n",
                        
                        "# --- 步驟 2：上傳檔案 ---\n",
                        "print(\"--- 步驟 2/3：請上傳您的音檔 --- (請在下方跳出的視窗選取檔案)\")\n",
                        "uploaded = files.upload()\n\n",
                        
                        "if not uploaded:\n",
                        "    print(\"\\n錯誤：您沒有上傳任何檔案。請重新執行此儲存格。\")\n",
                        "else:\n",
                        "    filename = next(iter(uploaded))\n",
                        "    print(f\"\\n成功上傳： {filename}\\n\")\n\n",
                        
                        "    # --- 步驟 3：執行轉錄 ---\n",
                        "    # 參數 (MODEL, LANGUAGE 等) 已在第一個隱藏儲存格中定義\n",
                        "    print(\"--- 步驟 3/3：正在組合指令並開始轉錄... ---\")\n",
                        "    print(f\"使用模型: {MODEL}, 語言: {'自動偵測' if not LANGUAGE else LANGUAGE}, 任務: {TASK}\")\n\n",
                        
                        "    # 組合 Whisper 指令\n",
                        "    cmd = f'whisper \"{filename}\" --model {MODEL} --task {TASK} --output_format {OUTPUT_FORMAT}'\n",
                        "    \n",
                        "    if LANGUAGE:\n",
                        "        cmd += f' --language \"{LANGUAGE}\"'\n",
                        "    \n",
                        "    if OUTPUT_DIR:\n",
                        "        cmd += f' --output_dir \"{OUTPUT_DIR}\"'\n",
                        "        os.makedirs(OUTPUT_DIR, exist_ok=True)\n",
                        "\n",
                        "    if DEVICE == \"cpu\":\n",
                        "        cmd += \" --device cpu --fp16 False\"\n",
                        "    else:\n",
                        "        cmd += \" --device cuda\" # 預設使用 Colab GPU\n",
                        "\n",
                        "    print(f\"\\n即將執行指令：\\n{cmd}\\n\")\n",
                        "    print(\"--- 開始執行 Whisper (請稍候，下載模型可能需要幾分鐘) ---\")\n",
                        "    \n",
                        "    # 執行指令\n",
                        "    try:\n",
                        "        get_ipython().system(cmd)\n",
                        "        print(\"\\n--- 轉錄執行完畢 ---\")\n",
                        "        if OUTPUT_DIR:\n",
                        "            print(f\"✅ 成功！檔案已儲存於左側檔案列表的 {OUTPUT_DIR} 資料夾中。\")\n",
                        "        else:\n",
                        "             print(\"✅ 成功！檔案已儲存於左側檔案列表中。\")\n",
                        "    except Exception as e:\n",
                        "        print(f\"執行 Whisper 時發生錯誤：{e}\")\n"
                    ],
                    "execution_count": null,
                    "outputs": []
                }
            ]
        };
        // =========================================================================
        // Google API 驗證與操作 (已更新 status 函式)
        // =========================================================================

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        const authButton = document.getElementById('authorize_button');
        const configForm = document.getElementById('config_form');
        const createButton = document.getElementById('create_button');
        const statusDiv = document.getElementById('status');
        
        // 表單元素
        const model_select = document.getElementById('model_select');
        const lang_select = document.getElementById('lang_select');
        const task_select = document.getElementById('task_select');
        const format_select = document.getElementById('format_select');
        const output_dir_input = document.getElementById('output_dir_input');
        const device_select = document.getElementById('device_select');


        authButton.onclick = handleAuthClick;
        createButton.onclick = handleCreateClick;

        /**
         * 更新狀態顯示 (新的函式)
         * @param {string} text 顯示的文字
         * @param {'info' | 'success' | 'error' | 'loading'} type 狀態類型
         */
        function updateStatus(text, type = 'info') {
            statusDiv.className = `status-${type}`;
            
            if (type === 'loading') {
                statusDiv.innerHTML = `<span class="loader"></span> ${text}`;
            } else {
                statusDiv.textContent = text;
            }
        }


        // 步驟 1: gapi (Google API Client) 載入完成
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        // 步驟 2: 初始化 gapi client
        async function initializeGapiClient() {
            await gapi.client.init({
                discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
            });
            gapiInited = true;
            checkReadyState();
        }

        // 步驟 3: gis (Google Identity Services) 載入完成
        function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: SCOPES,
                callback: '', // 我們將在 handleAuthClick 中處理回呼
            });
            gisInited = true;
            checkReadyState();
        }

        // 步驟 4: 檢查兩個函式庫是否都已載入
        function checkReadyState() {
            if (gapiInited && gisInited) {
                updateStatus('狀態：API 載入完成，請登入。', 'info');
            }
        }

        // 步驟 5: 處理「登入」按鈕點擊
        function handleAuthClick() {
            if (CLIENT_ID === 'YOUR_CLIENT_ID_GOES_HERE') {
                alert('錯誤：您尚未在 index.html 程式碼中填入您的 Client ID！');
                updateStatus('錯誤：尚未設定 Client ID。', 'error');
                return;
            }
            tokenClient.callback = async (resp) => {
                if (resp.error) {
                    throw (resp);
                }
                updateStatus('狀態：登入成功！請設定參數。', 'success');
                authButton.style.display = 'none'; // 隱藏登入按鈕
                configForm.style.display = 'block'; // 顯示設定表單
                createButton.style.display = 'inline-flex'; // 顯示建立按鈕
                createButton.disabled = false;
            };
            
            // 請求權杖
            tokenClient.requestAccessToken();
        }

        // 步驟 6: 處理「建立並啟動」按鈕點擊
        async function handleCreateClick() {
            try {
                updateStatus('狀態：正在讀取設定並建立筆記本...', 'loading');
                createButton.disabled = true;

                // --- 這是新的核心邏輯 ---
                // 1. 讀取 HTML 表單中的所有設定值
                const model = model_select.value;
                const language = lang_select.value;
                const task = task_select.value;
                const output_format = format_select.value;
                const output_dir = output_dir_input.value.trim();
                const device = device_select.value;
                
                // 2. 建立一個 Python 程式碼字串，用來定義這些變數
                // 注意：Python 字串需要用引號括起來，所以我們在 JS 中要處理 "
                const configCode = `
# --- 由啟動器自動產生的設定 (Auto-generated settings) ---
MODEL = "${model}"
LANGUAGE = "${language}"
TASK = "${task}"
OUTPUT_FORMAT = "${output_format}"
OUTPUT_DIR = "${output_dir}"
DEVICE = "${device}"
# ----------------------------------------------------
`;
                // 3. 建立這個設定檔的 Colab 儲存格 (cell)
                const configCell = {
                    "cell_type": "code",
                    "metadata": { 
                        "id": "config-cell-autogen",
                        "colab": { "jupyter": { "source_hidden": true } } // 預設摺疊此儲存格
                    },
                    "source": configCode.trim().split('\n'), // 轉換為 Colab 接受的行陣列
                    "execution_count": null,
                    "outputs": []
                };

                // 4. 取得筆記本模板，並將設定 cell 插入到最前面
                // **重要**：我們使用 deep copy (JSON.parse/stringify) 確保模板不被永久修改
                let notebookContent = JSON.parse(JSON.stringify(COLAB_NOTEBOOK_TEMPLATE));
                notebookContent.cells.unshift(configCell);
                
                // 5. 將修改後的筆記本內容轉換為字串
                const notebookString = JSON.stringify(notebookContent);
                
                // --- 舊的 Drive API 邏輯 (上傳檔案) ---
                const boundary = '-------314159265358979323846';
                const delimiter = "\r\n--" + boundary + "\rn";
                const close_delim = "\r\n--" + boundary + "--";

                const metadata = {
                    'name': `Whisper 轉錄筆記本 (${model}).ipynb`, // 檔名可以包含模型
                    'mimeType': 'application/vnd.google.colab' 
                };

                const requestBody =
                    delimiter +
                    'Content-Type: application/json; charset=UTF-8\r\n\r\n' +
                    JSON.stringify(metadata) +
                    delimiter +
                    'Content-Type: application/x-ipynb+json\r\n\r\n' +
                    notebookString +
                    close_delim;

                // 呼叫 Google Drive API (files.create)
                const response = await gapi.client.request({
                    'path': 'https://www.googleapis.com/upload/drive/v3/files',
                    'method': 'POST',
                    'params': { 'uploadType': 'multipart' },
                    'headers': {
                        'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                    },
                    'body': requestBody
                });

                const file = response.result;
                const fileId = file.id;
                
                updateStatus(`狀態：筆記本建立成功！正在為您開啟 Colab...`, 'success');
                
                // 在新分頁中開啟 Colab
                const colabUrl = `https://colab.research.google.com/drive/${fileId}`;
                window.open(colabUrl, '_blank');
                
                createButton.disabled = false;

            } catch (error) {
                console.error(error);
                let errorMsg = error.message || error.result?.error?.message || '未知錯誤';
                updateStatus(`錯誤： ${errorMsg}`, 'error');
                createButton.disabled = false;
            }
        }
    </script>

</body>
</html>